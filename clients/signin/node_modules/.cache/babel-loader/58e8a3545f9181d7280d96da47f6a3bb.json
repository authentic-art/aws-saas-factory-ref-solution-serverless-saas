{"ast":null,"code":"import _classCallCheck from\"/Users/l1/WebstormProjects/Amplify-AA/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/l1/WebstormProjects/Amplify-AA/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/l1/WebstormProjects/Amplify-AA/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/l1/WebstormProjects/Amplify-AA/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import*as React from'react';import{Redirect}from'react-router-dom';import{Spin,Icon,Button,Form,notification,Input,Col}from'antd';// amplify\nimport{Auth}from'aws-amplify';/** Presentational */import FullWidthWrapper from'../../Components/Styled/FullWidthWrapper';import EmailConfirmFormWrapper from'../../Components/Styled/EmailConfirmFormWrapper';var ConfirmEmailContainer=/*#__PURE__*/function(_React$Component){_inherits(ConfirmEmailContainer,_React$Component);var _super=_createSuper(ConfirmEmailContainer);function ConfirmEmailContainer(){var _this;_classCallCheck(this,ConfirmEmailContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={username:'',loading:false,redirect:false,confirmationCode:'',error:''};_this.handleSubmit=function(event){event.preventDefault();var confirmationCode=_this.state.confirmationCode;// show progress spinner\n_this.setState({loading:true});Auth.confirmSignUp(_this.state.username,confirmationCode).then(function(){_this.handleOpenNotification('success','Succesfully confirmed!','You will be redirected to login in a few!');}).catch(function(err){_this.handleOpenNotification('error','Invalid code',err.message);_this.setState({loading:false});});};_this.handleOpenNotification=function(type,title,message){switch(type){case'success':notification['success']({message:title,description:message,placement:'topRight',duration:1.5,onClose:function onClose(){_this.setState({redirect:true});}});break;case'error':notification['error']({message:title,description:message,placement:'topRight',duration:1.5});break;}};_this.handleOnPaste=function(event){event.preventDefault();var code=event.clipboardData.getData('Text').trim();/** Update input */_this.setState({confirmationCode:code});// regex to check if string is numbers only\nvar reg=new RegExp('^[0-9]+$');if(reg.test(code)&&code.length===6){// code is a valid number\n_this.setState({loading:true});Auth.confirmSignUp(_this.state.username,code).then(function(){_this.handleOpenNotification('success','Succesfully confirmed!','You will be redirected to login in a few!');}).catch(function(err){_this.handleOpenNotification('error','Invalid code',err.message);_this.setState({loading:false});});}};_this.handleChange=function(event){_this.setState({confirmationCode:event.currentTarget.value});};return _this;}_createClass(ConfirmEmailContainer,[{key:\"componentDidMount\",value:function componentDidMount(){if(this.props.location.search){// get username from url params\nvar username=this.props.location.search.split('=')[1];this.setState({username:username});}}},{key:\"render\",value:function render(){var _this$state=this.state,loading=_this$state.loading,error=_this$state.error,confirmationCode=_this$state.confirmationCode,redirect=_this$state.redirect;return/*#__PURE__*/React.createElement(FullWidthWrapper,{align:\"center\"},/*#__PURE__*/React.createElement(EmailConfirmFormWrapper,{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(Col,{md:24,lg:18},/*#__PURE__*/React.createElement(\"div\",{className:\"full-width\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Check your email\"),/*#__PURE__*/React.createElement(\"p\",null,\"We've sent a six\\xAD digit confirmation code\")),/*#__PURE__*/React.createElement(Form.Item,{validateStatus:error&&'error',help:error,label:\"Confirmation Code\"},/*#__PURE__*/React.createElement(Input,{size:\"large\",type:\"number\",placeholder:\"Enter confirmation code\",onChange:this.handleChange,onPaste:this.handleOnPaste,value:confirmationCode}))),/*#__PURE__*/React.createElement(Col,{md:24,lg:12},/*#__PURE__*/React.createElement(Button,{type:\"primary\",disabled:loading,htmlType:\"submit\",size:\"large\"},loading?/*#__PURE__*/React.createElement(Spin,{indicator:/*#__PURE__*/React.createElement(Icon,{type:\"loading\",style:{fontSize:24},spin:true})}):'Confirm Email'))),redirect&&/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/login'}}));}}]);return ConfirmEmailContainer;}(React.Component);export default ConfirmEmailContainer;","map":{"version":3,"names":["React","Redirect","Spin","Icon","Button","Form","notification","Input","Col","Auth","FullWidthWrapper","EmailConfirmFormWrapper","ConfirmEmailContainer","state","username","loading","redirect","confirmationCode","error","handleSubmit","event","preventDefault","setState","confirmSignUp","then","handleOpenNotification","catch","err","message","type","title","description","placement","duration","onClose","handleOnPaste","code","clipboardData","getData","trim","reg","RegExp","test","length","handleChange","currentTarget","value","props","location","search","split","fontSize","pathname","Component"],"sources":["/Users/l1/WebstormProjects/Amplify-AA/src/Containers/ConfirmEmailContainer/index.tsx"],"sourcesContent":["import * as React from 'react';\nimport { Redirect, RouteComponentProps } from 'react-router-dom';\nimport { Spin, Icon, Button, Form, notification, Input, Col } from 'antd';\n\n// amplify\nimport { Auth } from 'aws-amplify';\n\n/** Presentational */\nimport FullWidthWrapper from '../../Components/Styled/FullWidthWrapper';\nimport EmailConfirmFormWrapper from '../../Components/Styled/EmailConfirmFormWrapper';\n\ntype State = {\n  username: string;\n  loading: boolean;\n  redirect: boolean;\n  confirmationCode: string;\n  error: string;\n};\n\nclass ConfirmEmailContainer extends React.Component<RouteComponentProps, State> {\n  state = {\n    username: '',\n    loading: false,\n    redirect: false,\n    confirmationCode: '',\n    error: ''\n  };\n\n  componentDidMount() {\n    if (this.props.location.search) {\n      // get username from url params\n      let username = this.props.location.search.split('=')[1];\n\n      this.setState({ username });\n    }\n  }\n\n  handleSubmit = (event: React.FormEvent) => {\n    event.preventDefault();\n\n    const { confirmationCode } = this.state;\n\n    // show progress spinner\n    this.setState({ loading: true });\n\n    Auth.confirmSignUp(this.state.username, confirmationCode)\n      .then(() => {\n        this.handleOpenNotification('success', 'Succesfully confirmed!', 'You will be redirected to login in a few!');\n      })\n      .catch(err => {\n        this.handleOpenNotification('error', 'Invalid code', err.message);\n        this.setState({\n          loading: false\n        });\n      });\n  };\n\n  /**\n   * @param  {string} - type\n   * @param  {string} - title\n   * @param  {string} - message\n   *\n   * @returns {void} - no value returned\n   */\n  handleOpenNotification = (type: string, title: string, message: string): void => {\n    switch (type) {\n      case 'success':\n        notification['success']({\n          message: title,\n          description: message,\n          placement: 'topRight',\n          duration: 1.5,\n          onClose: () => {\n            this.setState({ redirect: true });\n          }\n        });\n        break;\n\n      case 'error':\n        notification['error']({\n          message: title,\n          description: message,\n          placement: 'topRight',\n          duration: 1.5\n        });\n        break;\n    }\n  };\n\n  handleOnPaste = (event: React.ClipboardEvent) => {\n    event.preventDefault();\n\n    let code = event.clipboardData.getData('Text').trim();\n\n    /** Update input */\n    this.setState({ confirmationCode: code });\n\n    // regex to check if string is numbers only\n    const reg = new RegExp('^[0-9]+$');\n\n    if (reg.test(code) && code.length === 6) {\n      // code is a valid number\n\n      this.setState({ loading: true });\n\n      Auth.confirmSignUp(this.state.username, code)\n        .then(() => {\n          this.handleOpenNotification('success', 'Succesfully confirmed!', 'You will be redirected to login in a few!');\n        })\n        .catch(err => {\n          this.handleOpenNotification('error', 'Invalid code', err.message);\n          this.setState({\n            loading: false\n          });\n        });\n    }\n  };\n\n  handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ confirmationCode: event.currentTarget.value });\n  };\n\n  render() {\n    const { loading, error, confirmationCode, redirect } = this.state;\n\n    return (\n      <FullWidthWrapper align=\"center\">\n        <EmailConfirmFormWrapper onSubmit={this.handleSubmit}>\n          <Col md={24} lg={18}>\n            <div className=\"full-width\">\n              <h2>Check your email</h2>\n              <p>We've sent a sixÂ­ digit confirmation code</p>\n            </div>\n            <Form.Item validateStatus={error && 'error'} help={error} label=\"Confirmation Code\">\n              <Input\n                size=\"large\"\n                type=\"number\"\n                placeholder=\"Enter confirmation code\"\n                onChange={this.handleChange}\n                onPaste={this.handleOnPaste}\n                value={confirmationCode}\n              />\n            </Form.Item>\n          </Col>\n          <Col md={24} lg={12}>\n            <Button type=\"primary\" disabled={loading} htmlType=\"submit\" size=\"large\">\n              {loading ? <Spin indicator={<Icon type=\"loading\" style={{ fontSize: 24 }} spin />} /> : 'Confirm Email'}\n            </Button>\n          </Col>\n        </EmailConfirmFormWrapper>\n        {redirect && <Redirect to={{ pathname: '/login' }} />}\n      </FullWidthWrapper>\n    );\n  }\n}\n\nexport default ConfirmEmailContainer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}